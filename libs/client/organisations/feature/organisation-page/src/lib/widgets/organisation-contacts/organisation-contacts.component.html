<ui-tilelayout-item id="organisation-contacts">
  <header header class="flex items-center justify-between gap-2">
    <h5 class="k-card-title">Contacts</h5>
    <img
      title="Source: DealRoom"
      kendoTooltip
      position="left"
      ngSrc="assets/images/dealroom-icon.svg"
      alt="Dealroom logo"
      width="26"
      height="26"
    />
  </header>

  <div body>
    <div>
      <kendo-grid
        (scrollBottom)="organisationContactsStore.scrollBottom()"
        (sortChange)="organisationContactsStore.sortChange($event)"
        [data]="organisationContactsStore.data()"
        [loading]="organisationContactsStore.isLoading()!"
        [rowClass]="rowCallback"
        [scrollable]="
          organisationContactsStore.canLoadMore() ? 'none' : 'scrollable'
        "
        [ngClass]="{
          'max-h-[185px]': organisationContactsStore.canLoadMore(),
          'max-h-[220px]': !organisationContactsStore.canLoadMore(),
          'min-h-[185px]': organisationContactsStore.canLoadMore(),
          'min-h-[223px]': !organisationContactsStore.canLoadMore()
        }"
        class="grid-borderless h-full"
      >
        <kendo-grid-column [width]="50" title="">
          <ng-template kendoGridCellTemplate>
            <i class="fa-solid fa-circle-user"></i>
          </ng-template>
        </kendo-grid-column>

        <kendo-grid-column field="name" headerClass="!font-bold" title="Name">
          <ng-template kendoGridCellTemplate let-contact>
            {{ contact.name }}
          </ng-template>
        </kendo-grid-column>

        <kendo-grid-column [width]="50" title="">
          <ng-template kendoGridCellTemplate let-contact>
            @if (contact?.email) {
              <a
                [href]="getMailto(contact.email)"
                aria-label="Contact person"
                class="contact-mailto"
              >
                <i class="fa-solid fa-envelope"></i>
              </a>
            }
          </ng-template>
        </kendo-grid-column>
      </kendo-grid>
      @if (organisationContactsStore.canLoadMore()) {
        <div class="mt-2 flex justify-center">
          <button
            (click)="loadMore()"
            kendoButton
            fillMode="flat"
            themeColor="primary"
          >
            Show
            {{ organisationContactsStore.loadMoreAmount() }}
            more
          </button>
        </div>
      }
    </div>
  </div>
</ui-tilelayout-item>
