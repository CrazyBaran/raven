<kendo-panelbar class="white-tilelayout">
  <kendo-panelbar-item [expanded]="false" title="Related Notes">
    <ng-template kendoPanelBarItemTitle>
      <div class="k-card-title !m-0 flex w-full items-center !text-black">
        Company Files

        @if (vm().hasFileFolder) {
          <app-picker-container
            class="ml-auto"
            theme="base"
            [sharepointFolder]="vm().sharepointFolder!"
          />
        }
      </div>
    </ng-template>
    <ng-template kendoPanelBarContent>
      <div class="h-[363px] overflow-auto">
        @if (vm().isLoading) {
        } @else if (vm().hasFileFolder) {
          <app-files-treelist-container
            [directoryUrl]="vm().sharepointDirectory!"
          />
        } @else {
          <div class="flex h-full flex-col items-center justify-center">
            <p class="text-subtle-text mb-1 text-sm italic">
              There is no existing folder in SharePoint for this company. To
              create one please click the button below.
            </p>
            <kendo-button
              (click)="createOrganisationFolder()"
              [disabled]="vm().isCreatingSharepointFolder"
            >
              @if (vm().isCreatingSharepointFolder) {
                <kendo-loader class="!text-secondary-100 mr-1" size="small" />
              }
              Create Organisation Folder
            </kendo-button>
          </div>
        }
      </div>
    </ng-template>
  </kendo-panelbar-item>
</kendo-panelbar>
