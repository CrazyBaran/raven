<kendo-grid
  [loading]="isLoading"
  [data]="organisations"
  class="grid-borderless h-full"
  [pageable]="true"
  [pageSize]="10"
  scrollable="scrollable"
>
  <kendo-grid-column
    title="Company"
    headerClass="!font-bold"
    class="!align-text-top"
  >
    <ng-template kendoGridCellTemplate let-dataItem>
      <div class="flex items-center gap-3">
        <i class="fa-regular fa-image text-xl"></i>
        <div
          class="hover:text-primary-600 group flex grow items-center gap-3 overflow-hidden transition-all duration-100 hover:cursor-pointer"
        >
          <div class="grow overflow-hidden">
            <p class="truncate group-hover:font-bold">{{ dataItem.name }}</p>
            <p class="truncate text-xs" *rxIf="dataItem.domains[0]">
              {{ dataItem.domains[0] }}
            </p>
          </div>
          <i class="fa-solid fa-share"></i>
        </div>
      </div>
    </ng-template>
  </kendo-grid-column>

  <kendo-grid-column title="Opportunity" headerClass="!font-bold">
    <ng-template kendoGridCellTemplate let-dataItem>
      <div class="flex flex-col gap-4">
        <div
          *rxFor="
            let opportunity of dataItem | expandableList: collapsedRows();
            strategy: 'immediate'
          "
        >
          <p>{{ opportunity.tag?.name ?? 'Unknown' }}</p>
          <p>{{ $any(opportunity).updated ?? 'Updated: dd/mm/yyyy' }}</p>
        </div>
      </div>
    </ng-template>
  </kendo-grid-column>

  <kendo-grid-column title="Pipeline Status" headerClass="!font-bold">
    <ng-template kendoGridCellTemplate let-dataItem>
      <div class="flex flex-col gap-4">
        <div
          *rxFor="
            let opportunity of dataItem | expandableList: collapsedRows();
            strategy: 'immediate'
          "
          class="flex h-10 items-center gap-3"
        >
          <i
            class="fa-solid fa-circle text-xs"
            [style.color]="opportunity.stageColor"
          ></i>
          <p class="flex-1 truncate text-black">
            {{ opportunity.stage.displayName }}
          </p>
        </div>
      </div>
    </ng-template>
  </kendo-grid-column>

  <kendo-grid-column title="Deal Lead" headerClass="!font-bold">
    <ng-template kendoGridCellTemplate let-dataItem>
      <div class="flex flex-col gap-4">
        <div
          *rxFor="
            let opportunity of dataItem | expandableList: collapsedRows();
            strategy: 'immediate'
          "
          class="flex h-10 items-center gap-1"
        >
          <i class="fa-solid fa-circle-user mr-1"></i>
          <p class="flex-1 truncate text-black">
            {{ 'Shaun Lee' }}
          </p>
        </div>
      </div>
    </ng-template>
  </kendo-grid-column>

  <kendo-grid-column title="Deal Team" headerClass="!font-bold">
    <ng-template kendoGridCellTemplate let-dataItem>
      <div class="flex flex-col gap-4">
        <div
          *rxFor="
            let opportunity of dataItem | expandableList: collapsedRows();
            strategy: 'immediate'
          "
          class="flex h-10 items-center gap-1"
        >
          <i class="fa-solid fa-circle-user mr-1"></i>
          <p class="flex-1 truncate text-black">
            {{ 'Shaun Lee' }}
          </p>
        </div>
      </div>
    </ng-template>
  </kendo-grid-column>

  <kendo-grid-column title="Tags" headerClass="!font-bold">
    <ng-template kendoGridCellTemplate let-dataItem>
      <div class="flex flex-col gap-4">
        <div
          *rxFor="
            let opportunity of dataItem | expandableList: collapsedRows();
            strategy: 'immediate'
          "
          class="flex h-10 items-center gap-1"
        >
          <i class="fa-solid fa-circle-user mr-1"></i>
          <p class="flex-1 truncate text-black">
            {{ 'Shaun Lee' }}
          </p>
        </div>
      </div>
    </ng-template>
  </kendo-grid-column>

  <kendo-grid-column title="" class="!align-text-top" [width]="90">
    <ng-template kendoGridCellTemplate let-dataItem>
      <div class="flex gap-1">
        <kendo-button
          themeColor="primary"
          iconClass="fa-solid fa-eye"
        ></kendo-button>
        <kendo-button iconClass="fa-solid fa-link"></kendo-button></div
    ></ng-template>
  </kendo-grid-column>
  <kendo-grid-column title="" class="!align-text-top" [width]="60">
    <ng-template kendoGridCellTemplate let-dataItem>
      <kendo-button
        *rxIf="dataItem.opportunities.length > 1"
        fillMode="link"
        [iconClass]="
          'fa-solid fa-caret-' + (isRowColapsed(dataItem.id) ? 'up' : 'down')
        "
        (click)="toggleRow(dataItem.id)"
      ></kendo-button>
    </ng-template>
  </kendo-grid-column>
</kendo-grid>
